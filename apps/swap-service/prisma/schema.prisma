generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

model Swap {
  id                               String         @id @default(cuid())
  swapId                           String         @unique
  sellAsset                        Json
  buyAsset                         Json
  sellAmountCryptoBaseUnit         String
  expectedBuyAmountCryptoBaseUnit  String
  sellAmountCryptoPrecision        String
  expectedBuyAmountCryptoPrecision String
  actualBuyAmountCryptoPrecision   String?
  status                           String         @default("PENDING")
  source                           String
  swapperName                      String
  sellAccountId                    String
  buyAccountId                     String?
  receiveAddress                   String?
  sellTxHash                       String?
  buyTxHash                        String?
  txLink                           String?
  statusMessage                    String?
  isStreaming                      Boolean        @default(false)
  estimatedCompletion              DateTime?
  createdAt                        DateTime       @default(now())
  updatedAt                        DateTime       @updatedAt
  metadata                         Json
  chainflipSwapId                  Int?
  relayTransactionMetadata         Json?
  relayerExplorerTxLink            String?
  relayerTxHash                    String?
  stepIndex                        Int            @default(0)
  streamingSwapMetadata            Json?
  userId                           String
  sellAmountUsd                    String?
  referralCode                     String?
  isReferralEligible               Boolean        @default(true)
  isAffiliateVerified              Boolean?
  affiliateVerificationDetails     Json?
  affiliateVerifiedAt              DateTime?

  @@index([referralCode])
  @@map("swaps")
}
